// Simple fantasy draft auction system

// ==========================
// FRONTEND: HTML + JavaScript
// ==========================
const players = [
    { id: 1, name: 'Player 1', highestBid: 0, highestBidder: '' },
    { id: 2, name: 'Player 2', highestBid: 0, highestBidder: '' },
    { id: 3, name: 'Player 3', highestBid: 0, highestBidder: '' }
];

let auctionEndTime = Date.now() + 30 * 60 * 1000; // 30-minute timer

// Update countdown timer
function updateTimer() {
    const now = Date.now();
    const timeLeft = Math.max(0, auctionEndTime - now);
    const minutes = Math.floor(timeLeft / (1000 * 60));
    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
    document.getElementById('timer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;

    if (timeLeft === 0) {
        clearInterval(timerInterval);
        alert('Auction has ended!');
    }
}
const timerInterval = setInterval(updateTimer, 1000);
updateTimer();

// Submit bid
async function submitBid(event) {
    event.preventDefault();
    const playerId = document.getElementById('playerSelect').value;
    const bidderName = document.getElementById('bidderName').value;
    const bidAmount = parseFloat(document.getElementById('bidAmount').value);

    const response = await fetch('https://fpl-auction.onrender.com', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ playerId, bidderName, bidAmount })
    });

    const result = await response.json();
    if (result.success) {
        loadPlayers();
    } else {
        alert(result.message);
    }
}

// Load players and update UI
async function loadPlayers() {
    const response = await fetch('https://fpl-auction.onrender.com');
    const players = await response.json();

    const playerTable = document.getElementById('playerTable');
    playerTable.innerHTML = '';

    players.forEach(player => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${player.name}</td>
            <td>${player.highestBid}</td>
            <td>${player.highestBidder}</td>
        `;
        playerTable.appendChild(row);
    });
}

document.getElementById('bidForm').addEventListener('submit', submitBid);
loadPlayers();
